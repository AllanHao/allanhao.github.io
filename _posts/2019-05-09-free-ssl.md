---
layout: post
title: Windows使用acme.sh申请let’s encrypt通配符域名
categories: [运维]
description: Windows使用acme.sh申请let’s encrypt通配符域名
keywords: 通配符域名, acme.sh,let’s encrypt
---

本文主要讲述在windows系统利用acme.sh申请https证书的方法，并且应用到IIS和Tomcat。

> 参考链接：https://blog.853lab.com/2018/09/post_1965.html

## 安装Cygwin

全程联网，安装Cygwin，直接点点点下一步，节点使用163节点（速度快，如果只想配置acme.sh的话）：http://mirrors.163.com/cygwin/ 或其他可以用的节点

![](https://allanhao.com/images/2019-05-22-14-53-07.png)

在选择包列表，选择curl、cron、bzip2、wget、gcc-core、gcc-g++、make、openssh、lynx，然后下一步

![](https://allanhao.com/images/2019-05-22-15-04-36.png)

一直下一步，Cygwin就安装好了（网络错误除外）然后在Windows的path变量下追加“;C:\cygwin64\bin;C:\cygwin64\usr\local\bin”

![](https://allanhao.com/images/2019-05-22-15-07-33.png)

![](https://allanhao.com/images/2019-05-22-15-07-46.png)

双击打开“C:\cygwin64”目录下的“Cygwin.bat”文件，运行以下命令：

```bat
curl https://get.acme.sh | sh
```

或者是：

```bat
wget -O -  https://get.acme.sh | sh
```

等待安装妥当，出现下面的界面代表安装完成（如果不显示或不显示最后的“Install success!”，估计是你安装Cygwin时没安装全所选的包。解决方法：不卸载再重新运行Cygwin安装包安装没有选上的包）

![](https://allanhao.com/images/2019-05-22-15-09-34.png)

**关掉并重新打开“C:\cygwin64”目录下的“Cygwin.bat”文件**，使用DNS方式来配置DNS API并申请域名证书。     
（这里用的是Aliyun DNS）    
!务必阅读![How to use DNS API](https://github.com/Neilpang/acme.sh/wiki/dnsapi)
AliyunDNS使用示范：
```bat
export Ali_Key="sdfsdfsdfljlbjkljlkjsdfoiwje"
export Ali_Secret="jlsdflanljkljlfdsaklkjflsa"
```

之后运行下面的命令申请（CloudXNS用的是–dns dns_cx，阿里云用的是–dns dns_ali，其他请参考[How to use DNS API](https://github.com/Neilpang/acme.sh/blob/master/dnsapi/README.md)）：
```bat
acme.sh --issue --dns dns_ali -d xxx.com -d *.xxx.com
```